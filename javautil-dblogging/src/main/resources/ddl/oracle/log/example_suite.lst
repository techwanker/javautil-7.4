SQL> 
SQL> --%## Define some procedures
SQL> --%```
SQL> 
SQL> --%### example_04
SQL> --%```
SQL> create or replace
  2  procedure example_04
  3  is
  4  	 token varchar(32);
  5  begin
  6  	 pllog.log('severe 1',1);
  7  	 pllog.log('warning 2',2);
  8  	 pllog.log('undefined 3',3);
  9  	 pllog.log('info 4',4);
 10  	 pllog.log('verbose 6',6);
 11  	 pllog.log('debug 7',7);
 12  	 pllog.log('trace 8',9);
 13  	 for lvl in 1 .. 9
 14  	 loop
 15  	     pllog.log('lvl is ' || lvl,lvl);
 16  	 end loop;
 17  end;
 18  --%```
 19  /

Procedure created.

SQL> 
SQL> --%### example_05
SQL> --%```
SQL> create or replace
  2  procedure example_05
  3  is
  4  begin
  5  	 pllog.log('severe 1',1);
  6  	 pllog.log('warning 2',2);
  7  	 pllog.log('undefined 3',3);
  8  	 pllog.log('info 4',4);
  9  	 pllog.log('verbose 6',6);
 10  	 pllog.log('debug 7',7);
 11  	 pllog.log('trace 8',9);
 12  	 for lvl in 1 .. 9
 13  	 loop
 14  	     pllog.log('lvl is ' || lvl,lvl);
 15  	 end loop;
 16  	 pllog.end_job;
 17  end;
 18  --%```
 19  /

Procedure created.

SQL> 
SQL> begin
  2    pllog.set_debug;
  3    pllog.log('no logfile specified');
  4  end;
  5  /
get_log_level() my_logger_name: "ANONYMOUS"                                     
get_log_level()  logger: "anonymous" was not found  level:  retval: 4           
open_log_file() dir: "" file: ""                                                
begin
*
ERROR at line 1:
ORA-29280: invalid directory path 
ORA-06512: at "SYS.UTL_FILE", line 41 
ORA-06512: at "SYS.UTL_FILE", line 478 
ORA-06512: at "SR.PLLOG", line 300 
ORA-06512: at "SR.PLLOG", line 587 
ORA-06512: at line 3 


SQL> 
SQL> --%# Example usage
SQL> --%
SQL> --%
SQL> --%* begin_log (logfile_name, p_log_level)
SQL> --%
SQL> --%  A logfile will be created in the *job_msg_dir* directory and
SQL> --%  unless other filters are applied messages of level 3 and lower
SQL> --%  will be written
SQL> --%
SQL> --%* set_caller_level(unit_name,level)
SQL> --%
SQL> --%  All messages for procedure *example_05* of with a level of 8
SQL> --%  or less will be written
SQL> --%```
SQL> declare
  2  	 token varchar(32);
  3  	 logname varchar(32) := to_char(job_log_id_seq.nextval) || '.log';
  4  begin
  5  	pllog.set_debug;
  6  	pllog.begin_log(logfile_name => logname, p_log_level => 3);
  7  	pllog.set_caller_level('example_05',8);
  8  	example_01;
  9  	example_04;
 10  	example_05;
 11  end;
 12  --%```
 13  /
begin_log() logfile_name "567.log"                                              
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 1,"2020-05-15T21:57:11.931975000","severe","EXAMPLE_01",4,,,""           
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 2,"2020-05-15T21:57:11.935657000","warning","EXAMPLE_01",5,,,""          
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 3,"2020-05-15T21:57:11.937409000","undefined","EXAMPLE_01",6,,,""        
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
log()       caller: EXAMPLE_01 line: 7 my_logger_level: 3 p_log_level: 4        
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
log()       caller: EXAMPLE_01 line: 8 my_logger_level: 3 p_log_level: 6        
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
log()       caller: EXAMPLE_01 line: 9 my_logger_level: 3 p_log_level: 7        
get_log_level() my_logger_name: "EXAMPLE_01"                                    
get_log_level()  logger: "EXAMPLE_01" was not found  level:  retval: 3          
log()       caller: EXAMPLE_01 line: 10 my_logger_level: 3 p_log_level: 9       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 1,"2020-05-15T21:57:11.946524000","severe 1","EXAMPLE_04",5,,,""         
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 2,"2020-05-15T21:57:11.948347000","warning 2","EXAMPLE_04",6,,,""        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 3,"2020-05-15T21:57:11.950106000","undefined 3","EXAMPLE_04",7,,,""      
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 8 my_logger_level: 3 p_log_level: 4        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 9 my_logger_level: 3 p_log_level: 6        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 10 my_logger_level: 3 p_log_level: 7       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 11 my_logger_level: 3 p_log_level: 9       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 1,"2020-05-15T21:57:11.958222000","lvl is 1","EXAMPLE_04",14,,,""        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 2,"2020-05-15T21:57:11.959805000","lvl is 2","EXAMPLE_04",14,,,""        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 3,"2020-05-15T21:57:11.961336000","lvl is 3","EXAMPLE_04",14,,,""        
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 4       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 5       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 6       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 7       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 8       
get_log_level() my_logger_name: "EXAMPLE_04"                                    
get_log_level()  logger: "EXAMPLE_04" was not found  level:  retval: 3          
log()       caller: EXAMPLE_04 line: 14 my_logger_level: 3 p_log_level: 9       
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 1,"2020-05-15T21:57:11.969439000","severe 1","EXAMPLE_05",4,,,""         
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 2,"2020-05-15T21:57:11.969547000","warning 2","EXAMPLE_05",5,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 3,"2020-05-15T21:57:11.969639000","undefined 3","EXAMPLE_05",6,,,""      
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 4,"2020-05-15T21:57:11.969725000","info 4","EXAMPLE_05",7,,,""           
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 6,"2020-05-15T21:57:11.969814000","verbose 6","EXAMPLE_05",8,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 7,"2020-05-15T21:57:11.969898000","debug 7","EXAMPLE_05",9,,,""          
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
log()       caller: EXAMPLE_05 line: 10 my_logger_level: 8 p_log_level: 9       
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 1,"2020-05-15T21:57:11.970004000","lvl is 1","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 2,"2020-05-15T21:57:11.970086000","lvl is 2","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 3,"2020-05-15T21:57:11.970169000","lvl is 3","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 4,"2020-05-15T21:57:11.970251000","lvl is 4","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 5,"2020-05-15T21:57:11.970332000","lvl is 5","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 6,"2020-05-15T21:57:11.970443000","lvl is 6","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 7,"2020-05-15T21:57:11.970555000","lvl is 7","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
open_log_file() dir: "JOB_MSG_DIR" file: "567.log"                              
log(): 8,"2020-05-15T21:57:11.970637000","lvl is 8","EXAMPLE_05",13,,,""        
get_log_level() my_logger_name: "EXAMPLE_05"                                    
get_log_level() my_dtl_log: "EXAMPLE_05"                                        
get_log_level()  logger: "EXAMPLE_05"  was  found  level: 8 retval: 8           
log()       caller: EXAMPLE_05 line: 13 my_logger_level: 8 p_log_level: 9       

PL/SQL procedure successfully completed.

SQL> exit;
